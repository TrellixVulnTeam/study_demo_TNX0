import Nio
import numpy as np
import numpy.testing as nt
import os
import unittest as ut

file_to_test = '../ncarg/data/netcdf/test_hgroups.nc'

class Test(ut.TestCase):
    def setUp(self):
        self.f = Nio.open_file(os.path.realpath(os.path.join(os.path.dirname(__file__), file_to_test)))

    def test_netcdf4_groups(self):
        nt.assert_equal(set(self.f.groups.keys()), set(file_groups))

    def test_netcdf4_variables(self):
        nt.assert_equal(set(self.f.variables.keys()), set(file_variables))

    def test_netcdf4_attributes(self):
        nt.assert_equal(self.f.attributes, file_attributes)

    def test_netcdf4_dimensions(self):
        nt.assert_equal(self.f.dimensions, file_dimensions)

    def test_netcdf4_var_shapes(self):
        for var in self.f.variables.keys():
            v = self.f.variables[var]
            nt.assert_equal(v.shape, var_shapes[var])

    def test_netcdf4_var_attributes(self):
        for var in self.f.variables.keys():
            v = self.f.variables[var]
            nt.assert_equal(v.attributes, var_attributes[var])

    def test_netcdf4_var_dimensions(self):
        for var in self.f.variables.keys():
            v = self.f.variables[var]
            nt.assert_equal(v.dimensions, var_dimensions[var])

    def test_netcdf4_var_coordinates(self):
        for var in self.f.variables.keys():
            v = self.f.variables[var]
            nt.assert_equal(get_coord_dims(v), var_coordinates[var])

    def test_netcdf4_var_values(self):
        for var in var_values.keys():
            v = self.f.variables[var]
            val = v.get_value()
            nt.assert_almost_equal((val.min(), val.max(), val.mean(), np.ma.count_masked(val)), var_values[var])


file_attributes = {'mozaic_flight_2012030403540535_ascent/airport_dep': 'TLV', 'mozaic_flight_2012030403540535_ascent/flight': '2012030403540535', 'mozaic_flight_2012030403540535_ascent/level': 'calibrated', 'mozaic_flight_2012030403540535_ascent/airport_arr': 'FRA', 'mozaic_flight_2012030403540535_ascent/mission': 'mozaic', 'mozaic_flight_2012030403540535_ascent/time_dep': '2012-03-04 03:54:05', 'mozaic_flight_2012030403540535_ascent/aircraft': '3', 'mozaic_flight_2012030403540535_ascent/link': 'http://www.iagos.fr/extract', 'mozaic_flight_2012030403540535_ascent/phase': 'ascent', 'mozaic_flight_2012030403540535_ascent/time_arr': '2012-03-04 08:01:44', 'mozaic_flight_2012030321335035_descent/airport_dep': 'FRA', 'mozaic_flight_2012030321335035_descent/flight': '2012030321335035', 'mozaic_flight_2012030321335035_descent/level': 'calibrated', 'mozaic_flight_2012030321335035_descent/airport_arr': 'TLV', 'mozaic_flight_2012030321335035_descent/mission': 'mozaic', 'mozaic_flight_2012030321335035_descent/time_dep': '2012-03-03 09:33:50', 'mozaic_flight_2012030321335035_descent/aircraft': '3', 'mozaic_flight_2012030321335035_descent/link': 'http://www.iagos.fr/extract', 'mozaic_flight_2012030321335035_descent/phase': 'descent', 'mozaic_flight_2012030321335035_descent/time_arr': '2012-03-04 01:05:08', 'mozaic_flight_2012030403540535_descent/airport_dep': 'TLV', 'mozaic_flight_2012030403540535_descent/flight': '2012030403540535', 'mozaic_flight_2012030403540535_descent/level': 'calibrated', 'mozaic_flight_2012030403540535_descent/airport_arr': 'FRA', 'mozaic_flight_2012030403540535_descent/mission': 'mozaic', 'mozaic_flight_2012030403540535_descent/time_dep': '2012-03-04 03:54:05', 'mozaic_flight_2012030403540535_descent/aircraft': '3', 'mozaic_flight_2012030403540535_descent/link': 'http://www.iagos.fr/extract', 'mozaic_flight_2012030403540535_descent/phase': 'descent', 'mozaic_flight_2012030403540535_descent/time_arr': '2012-03-04 08:01:44', 'mozaic_flight_2012030412545335_ascent/airport_dep': 'FRA', 'mozaic_flight_2012030412545335_ascent/flight': '2012030412545335', 'mozaic_flight_2012030412545335_ascent/level': 'calibrated', 'mozaic_flight_2012030412545335_ascent/airport_arr': 'NGO', 'mozaic_flight_2012030412545335_ascent/mission': 'mozaic', 'mozaic_flight_2012030412545335_ascent/time_dep': '2012-03-04 12:54:53', 'mozaic_flight_2012030412545335_ascent/aircraft': '3', 'mozaic_flight_2012030412545335_ascent/link': 'http://www.iagos.fr/extract', 'mozaic_flight_2012030412545335_ascent/phase': 'ascent', 'mozaic_flight_2012030412545335_ascent/time_arr': '2012-03-05 12:21:37', 'mozaic_flight_2012030419144751_ascent/airport_dep': 'FRA', 'mozaic_flight_2012030419144751_ascent/flight': '2012030419144751', 'mozaic_flight_2012030419144751_ascent/level': 'calibrated', 'mozaic_flight_2012030419144751_ascent/airport_arr': 'WDH', 'mozaic_flight_2012030419144751_ascent/mission': 'mozaic', 'mozaic_flight_2012030419144751_ascent/time_dep': '2012-03-04 07:14:47', 'mozaic_flight_2012030419144751_ascent/aircraft': '2', 'mozaic_flight_2012030419144751_ascent/link': 'http://www.iagos.fr/extract', 'mozaic_flight_2012030419144751_ascent/phase': 'ascent', 'mozaic_flight_2012030419144751_ascent/time_arr': '2012-03-05 04:49:45', 'mozaic_flight_2012030319051051_descent/airport_dep': 'WDH', 'mozaic_flight_2012030319051051_descent/flight': '2012030319051051', 'mozaic_flight_2012030319051051_descent/level': 'calibrated', 'mozaic_flight_2012030319051051_descent/airport_arr': 'FRA', 'mozaic_flight_2012030319051051_descent/mission': 'mozaic', 'mozaic_flight_2012030319051051_descent/time_dep': '2012-03-03 07:05:10', 'mozaic_flight_2012030319051051_descent/aircraft': '2', 'mozaic_flight_2012030319051051_descent/link': 'http://www.iagos.fr/extract', 'mozaic_flight_2012030319051051_descent/phase': 'descent', 'mozaic_flight_2012030319051051_descent/time_arr': '2012-03-04 04:46:40', 'mozaic_flight_2012030421382353_ascent/airport_dep': 'FRA', 'mozaic_flight_2012030421382353_ascent/flight': '2012030421382353', 'mozaic_flight_2012030421382353_ascent/level': 'calibrated', 'mozaic_flight_2012030421382353_ascent/airport_arr': 'TLV', 'mozaic_flight_2012030421382353_ascent/mission': 'mozaic', 'mozaic_flight_2012030421382353_ascent/time_dep': '2012-03-04 09:38:23', 'mozaic_flight_2012030421382353_ascent/aircraft': '4', 'mozaic_flight_2012030421382353_ascent/link': 'http://www.iagos.fr/extract', 'mozaic_flight_2012030421382353_ascent/phase': 'ascent', 'mozaic_flight_2012030421382353_ascent/time_arr': '2012-03-05 01:13:34'}
file_dimensions = {'recNum': 74, 'mozaic_flight_2012030321335035_descent/air_press': 76, 'mozaic_flight_2012030403540535_descent/air_press': 78, 'mozaic_flight_2012030412545335_ascent/air_press': 60, 'mozaic_flight_2012030419144751_ascent/air_press': 60, 'mozaic_flight_2012030319051051_descent/air_press': 78, 'mozaic_flight_2012030421382353_ascent/air_press': 75}
file_groups = ['mozaic_flight_2012030403540535_ascent', 'mozaic_flight_2012030321335035_descent', 'mozaic_flight_2012030403540535_descent', 'mozaic_flight_2012030412545335_ascent', 'mozaic_flight_2012030419144751_ascent', 'mozaic_flight_2012030319051051_descent', 'mozaic_flight_2012030421382353_ascent', '/']
file_variables = ['UTC_time', 'mozaic_flight_2012030403540535_ascent/air_press', 'mozaic_flight_2012030403540535_ascent/CO', 'mozaic_flight_2012030403540535_ascent/O3', 'mozaic_flight_2012030403540535_ascent/altitude', 'mozaic_flight_2012030403540535_ascent/lat', 'mozaic_flight_2012030403540535_ascent/lon', 'mozaic_flight_2012030321335035_descent/air_press', 'mozaic_flight_2012030321335035_descent/CO', 'mozaic_flight_2012030321335035_descent/O3', 'mozaic_flight_2012030321335035_descent/altitude', 'mozaic_flight_2012030321335035_descent/UTC_time', 'mozaic_flight_2012030321335035_descent/lat', 'mozaic_flight_2012030321335035_descent/lon', 'mozaic_flight_2012030403540535_descent/air_press', 'mozaic_flight_2012030403540535_descent/CO', 'mozaic_flight_2012030403540535_descent/O3', 'mozaic_flight_2012030403540535_descent/altitude', 'mozaic_flight_2012030403540535_descent/UTC_time', 'mozaic_flight_2012030403540535_descent/lat', 'mozaic_flight_2012030403540535_descent/lon', 'mozaic_flight_2012030412545335_ascent/air_press', 'mozaic_flight_2012030412545335_ascent/CO', 'mozaic_flight_2012030412545335_ascent/O3', 'mozaic_flight_2012030412545335_ascent/altitude', 'mozaic_flight_2012030412545335_ascent/UTC_time', 'mozaic_flight_2012030412545335_ascent/lat', 'mozaic_flight_2012030412545335_ascent/lon', 'mozaic_flight_2012030419144751_ascent/air_press', 'mozaic_flight_2012030419144751_ascent/CO', 'mozaic_flight_2012030419144751_ascent/O3', 'mozaic_flight_2012030419144751_ascent/altitude', 'mozaic_flight_2012030419144751_ascent/UTC_time', 'mozaic_flight_2012030419144751_ascent/lat', 'mozaic_flight_2012030419144751_ascent/lon', 'mozaic_flight_2012030319051051_descent/air_press', 'mozaic_flight_2012030319051051_descent/CO', 'mozaic_flight_2012030319051051_descent/O3', 'mozaic_flight_2012030319051051_descent/altitude', 'mozaic_flight_2012030319051051_descent/UTC_time', 'mozaic_flight_2012030319051051_descent/lat', 'mozaic_flight_2012030319051051_descent/lon', 'mozaic_flight_2012030421382353_ascent/air_press', 'mozaic_flight_2012030421382353_ascent/CO', 'mozaic_flight_2012030421382353_ascent/O3', 'mozaic_flight_2012030421382353_ascent/altitude', 'mozaic_flight_2012030421382353_ascent/UTC_time', 'mozaic_flight_2012030421382353_ascent/lat', 'mozaic_flight_2012030421382353_ascent/lon']

var_attributes = {'UTC_time': {'name': 'time', 'unit': 'none'},
                  'mozaic_flight_2012030403540535_ascent/air_press': {'name': 'air_pressure', 'unit': 'Pa'},
                  'mozaic_flight_2012030403540535_ascent/CO': {'name': 'mole_fraction_of_carbon_monoxide_in_air', 'unit': 'ppb'},
                  'mozaic_flight_2012030403540535_ascent/O3': {'name': 'mole_fraction_of_ozone_in_air', 'unit': 'ppb'},
                  'mozaic_flight_2012030403540535_ascent/altitude': {'name': 'barometric_altitude', 'unit': 'm'},
                  'mozaic_flight_2012030403540535_ascent/lat': {'standard_name': 'latitude', 'units': 'degree_north'},
                  'mozaic_flight_2012030403540535_ascent/lon': {'standard_name': 'longitude', 'units': 'degree_east'},
                  'mozaic_flight_2012030321335035_descent/air_press': {'name': 'air_pressure', 'unit': 'Pa'},
                  'mozaic_flight_2012030321335035_descent/CO': {'name': 'mole_fraction_of_carbon_monoxide_in_air', 'unit': 'ppb'},
                  'mozaic_flight_2012030321335035_descent/O3': {'name': 'mole_fraction_of_ozone_in_air', 'unit': 'ppb'},
                  'mozaic_flight_2012030321335035_descent/altitude': {'name': 'barometric_altitude', 'unit': 'm'},
                  'mozaic_flight_2012030321335035_descent/UTC_time': {'name': 'time', 'unit': 'none'},
                  'mozaic_flight_2012030321335035_descent/lat': {'standard_name': 'latitude', 'units': 'degree_north'},
                  'mozaic_flight_2012030321335035_descent/lon': {'standard_name': 'longitude', 'units': 'degree_east'},
                  'mozaic_flight_2012030403540535_descent/air_press': {'name': 'air_pressure', 'unit': 'Pa'},
                  'mozaic_flight_2012030403540535_descent/CO': {'name': 'mole_fraction_of_carbon_monoxide_in_air', 'unit': 'ppb'},
                  'mozaic_flight_2012030403540535_descent/O3': {'name': 'mole_fraction_of_ozone_in_air', 'unit': 'ppb'},
                  'mozaic_flight_2012030403540535_descent/altitude': {'name': 'barometric_altitude', 'unit': 'm'},
                  'mozaic_flight_2012030403540535_descent/UTC_time': {'name': 'time', 'unit': 'none'},
                  'mozaic_flight_2012030403540535_descent/lat': {'standard_name': 'latitude', 'units': 'degree_north'},
                  'mozaic_flight_2012030403540535_descent/lon': {'standard_name': 'longitude', 'units': 'degree_east'},
                  'mozaic_flight_2012030412545335_ascent/air_press': {'name': 'air_pressure', 'unit': 'Pa'},
                  'mozaic_flight_2012030412545335_ascent/CO': {'name': 'mole_fraction_of_carbon_monoxide_in_air', 'unit': 'ppb'},
                  'mozaic_flight_2012030412545335_ascent/O3': {'name': 'mole_fraction_of_ozone_in_air', 'unit': 'ppb'},
                  'mozaic_flight_2012030412545335_ascent/altitude': {'name': 'barometric_altitude', 'unit': 'm'},
                  'mozaic_flight_2012030412545335_ascent/UTC_time': {'name': 'time', 'unit': 'none'},
                  'mozaic_flight_2012030412545335_ascent/lat': {'standard_name': 'latitude', 'units': 'degree_north'},
                  'mozaic_flight_2012030412545335_ascent/lon': {'standard_name': 'longitude', 'units': 'degree_east'},
                  'mozaic_flight_2012030419144751_ascent/air_press': {'name': 'air_pressure', 'unit': 'Pa'},
                  'mozaic_flight_2012030419144751_ascent/CO': {'name': 'mole_fraction_of_carbon_monoxide_in_air', 'unit': 'ppb'},
                  'mozaic_flight_2012030419144751_ascent/O3': {'name': 'mole_fraction_of_ozone_in_air', 'unit': 'ppb'},
                  'mozaic_flight_2012030419144751_ascent/altitude': {'name': 'barometric_altitude', 'unit': 'm'},
                  'mozaic_flight_2012030419144751_ascent/UTC_time': {'name': 'time', 'unit': 'none'},
                  'mozaic_flight_2012030419144751_ascent/lat': {'standard_name': 'latitude', 'units': 'degree_north'},
                  'mozaic_flight_2012030419144751_ascent/lon': {'standard_name': 'longitude', 'units': 'degree_east'},
                  'mozaic_flight_2012030319051051_descent/air_press': {'name': 'air_pressure', 'unit': 'Pa'},
                  'mozaic_flight_2012030319051051_descent/CO': {'name': 'mole_fraction_of_carbon_monoxide_in_air', 'unit': 'ppb'},
                  'mozaic_flight_2012030319051051_descent/O3': {'name': 'mole_fraction_of_ozone_in_air', 'unit': 'ppb'},
                  'mozaic_flight_2012030319051051_descent/altitude': {'name': 'barometric_altitude', 'unit': 'm'},
                  'mozaic_flight_2012030319051051_descent/UTC_time': {'name': 'time', 'unit': 'none'},
                  'mozaic_flight_2012030319051051_descent/lat': {'standard_name': 'latitude', 'units': 'degree_north'},
                  'mozaic_flight_2012030319051051_descent/lon': {'standard_name': 'longitude', 'units': 'degree_east'},
                  'mozaic_flight_2012030421382353_ascent/air_press': {'name': 'air_pressure', 'unit': 'Pa'},
                  'mozaic_flight_2012030421382353_ascent/CO': {'name': 'mole_fraction_of_carbon_monoxide_in_air', 'unit': 'ppb'},
                  'mozaic_flight_2012030421382353_ascent/O3': {'name': 'mole_fraction_of_ozone_in_air', 'unit': 'ppb'},
                  'mozaic_flight_2012030421382353_ascent/altitude': {'name': 'barometric_altitude', 'unit': 'm'},
                  'mozaic_flight_2012030421382353_ascent/UTC_time': {'name': 'time', 'unit': 'none'},
                  'mozaic_flight_2012030421382353_ascent/lat': {'standard_name': 'latitude', 'units': 'degree_north'},
                  'mozaic_flight_2012030421382353_ascent/lon': {'standard_name': 'longitude', 'units': 'degree_east'}}
var_coordinates = {'UTC_time': [], 'mozaic_flight_2012030403540535_ascent/air_press': [], 'mozaic_flight_2012030403540535_ascent/CO': [], 'mozaic_flight_2012030403540535_ascent/O3': [], 'mozaic_flight_2012030403540535_ascent/altitude': [], 'mozaic_flight_2012030403540535_ascent/lat': [], 'mozaic_flight_2012030403540535_ascent/lon': [], 'mozaic_flight_2012030321335035_descent/air_press': [], 'mozaic_flight_2012030321335035_descent/CO': [], 'mozaic_flight_2012030321335035_descent/O3': [], 'mozaic_flight_2012030321335035_descent/altitude': [], 'mozaic_flight_2012030321335035_descent/UTC_time': [], 'mozaic_flight_2012030321335035_descent/lat': [], 'mozaic_flight_2012030321335035_descent/lon': [], 'mozaic_flight_2012030403540535_descent/air_press': [], 'mozaic_flight_2012030403540535_descent/CO': [], 'mozaic_flight_2012030403540535_descent/O3': [], 'mozaic_flight_2012030403540535_descent/altitude': [], 'mozaic_flight_2012030403540535_descent/UTC_time': [], 'mozaic_flight_2012030403540535_descent/lat': [], 'mozaic_flight_2012030403540535_descent/lon': [], 'mozaic_flight_2012030412545335_ascent/air_press': [], 'mozaic_flight_2012030412545335_ascent/CO': [], 'mozaic_flight_2012030412545335_ascent/O3': [], 'mozaic_flight_2012030412545335_ascent/altitude': [], 'mozaic_flight_2012030412545335_ascent/UTC_time': [], 'mozaic_flight_2012030412545335_ascent/lat': [], 'mozaic_flight_2012030412545335_ascent/lon': [], 'mozaic_flight_2012030419144751_ascent/air_press': [], 'mozaic_flight_2012030419144751_ascent/CO': [], 'mozaic_flight_2012030419144751_ascent/O3': [], 'mozaic_flight_2012030419144751_ascent/altitude': [], 'mozaic_flight_2012030419144751_ascent/UTC_time': [], 'mozaic_flight_2012030419144751_ascent/lat': [], 'mozaic_flight_2012030419144751_ascent/lon': [], 'mozaic_flight_2012030319051051_descent/air_press': [], 'mozaic_flight_2012030319051051_descent/CO': [], 'mozaic_flight_2012030319051051_descent/O3': [], 'mozaic_flight_2012030319051051_descent/altitude': [], 'mozaic_flight_2012030319051051_descent/UTC_time': [], 'mozaic_flight_2012030319051051_descent/lat': [], 'mozaic_flight_2012030319051051_descent/lon': [], 'mozaic_flight_2012030421382353_ascent/air_press': [], 'mozaic_flight_2012030421382353_ascent/CO': [], 'mozaic_flight_2012030421382353_ascent/O3': [], 'mozaic_flight_2012030421382353_ascent/altitude': [], 'mozaic_flight_2012030421382353_ascent/UTC_time': [], 'mozaic_flight_2012030421382353_ascent/lat': [], 'mozaic_flight_2012030421382353_ascent/lon': []}
var_dimensions = {'UTC_time': ('recNum',), 'mozaic_flight_2012030403540535_ascent/air_press': ('recNum',), 'mozaic_flight_2012030403540535_ascent/CO': ('recNum',), 'mozaic_flight_2012030403540535_ascent/O3': ('recNum',), 'mozaic_flight_2012030403540535_ascent/altitude': ('recNum',), 'mozaic_flight_2012030403540535_ascent/lat': (), 'mozaic_flight_2012030403540535_ascent/lon': (), 'mozaic_flight_2012030321335035_descent/air_press': ('air_press',), 'mozaic_flight_2012030321335035_descent/CO': ('air_press',), 'mozaic_flight_2012030321335035_descent/O3': ('air_press',), 'mozaic_flight_2012030321335035_descent/altitude': ('air_press',), 'mozaic_flight_2012030321335035_descent/UTC_time': ('air_press',), 'mozaic_flight_2012030321335035_descent/lat': (), 'mozaic_flight_2012030321335035_descent/lon': (), 'mozaic_flight_2012030403540535_descent/air_press': ('air_press',), 'mozaic_flight_2012030403540535_descent/CO': ('air_press',), 'mozaic_flight_2012030403540535_descent/O3': ('air_press',), 'mozaic_flight_2012030403540535_descent/altitude': ('air_press',), 'mozaic_flight_2012030403540535_descent/UTC_time': ('air_press',), 'mozaic_flight_2012030403540535_descent/lat': (), 'mozaic_flight_2012030403540535_descent/lon': (), 'mozaic_flight_2012030412545335_ascent/air_press': ('air_press',), 'mozaic_flight_2012030412545335_ascent/CO': ('air_press',), 'mozaic_flight_2012030412545335_ascent/O3': ('air_press',), 'mozaic_flight_2012030412545335_ascent/altitude': ('air_press',), 'mozaic_flight_2012030412545335_ascent/UTC_time': ('air_press',), 'mozaic_flight_2012030412545335_ascent/lat': (), 'mozaic_flight_2012030412545335_ascent/lon': (), 'mozaic_flight_2012030419144751_ascent/air_press': ('air_press',), 'mozaic_flight_2012030419144751_ascent/CO': ('air_press',), 'mozaic_flight_2012030419144751_ascent/O3': ('air_press',), 'mozaic_flight_2012030419144751_ascent/altitude': ('air_press',), 'mozaic_flight_2012030419144751_ascent/UTC_time': ('air_press',), 'mozaic_flight_2012030419144751_ascent/lat': (), 'mozaic_flight_2012030419144751_ascent/lon': (), 'mozaic_flight_2012030319051051_descent/air_press': ('air_press',), 'mozaic_flight_2012030319051051_descent/CO': ('air_press',), 'mozaic_flight_2012030319051051_descent/O3': ('air_press',), 'mozaic_flight_2012030319051051_descent/altitude': ('air_press',), 'mozaic_flight_2012030319051051_descent/UTC_time': ('air_press',), 'mozaic_flight_2012030319051051_descent/lat': (), 'mozaic_flight_2012030319051051_descent/lon': (), 'mozaic_flight_2012030421382353_ascent/air_press': ('air_press',), 'mozaic_flight_2012030421382353_ascent/CO': ('air_press',), 'mozaic_flight_2012030421382353_ascent/O3': ('air_press',), 'mozaic_flight_2012030421382353_ascent/altitude': ('air_press',), 'mozaic_flight_2012030421382353_ascent/UTC_time': ('air_press',), 'mozaic_flight_2012030421382353_ascent/lat': (), 'mozaic_flight_2012030421382353_ascent/lon': ()}
var_shapes = {'UTC_time': (74,), 'mozaic_flight_2012030403540535_ascent/air_press': (74,), 'mozaic_flight_2012030403540535_ascent/CO': (74,), 'mozaic_flight_2012030403540535_ascent/O3': (74,), 'mozaic_flight_2012030403540535_ascent/altitude': (74,), 'mozaic_flight_2012030403540535_ascent/lat': (), 'mozaic_flight_2012030403540535_ascent/lon': (), 'mozaic_flight_2012030321335035_descent/air_press': (76,), 'mozaic_flight_2012030321335035_descent/CO': (76,), 'mozaic_flight_2012030321335035_descent/O3': (76,), 'mozaic_flight_2012030321335035_descent/altitude': (76,), 'mozaic_flight_2012030321335035_descent/UTC_time': (76,), 'mozaic_flight_2012030321335035_descent/lat': (), 'mozaic_flight_2012030321335035_descent/lon': (), 'mozaic_flight_2012030403540535_descent/air_press': (78,), 'mozaic_flight_2012030403540535_descent/CO': (78,), 'mozaic_flight_2012030403540535_descent/O3': (78,), 'mozaic_flight_2012030403540535_descent/altitude': (78,), 'mozaic_flight_2012030403540535_descent/UTC_time': (78,), 'mozaic_flight_2012030403540535_descent/lat': (), 'mozaic_flight_2012030403540535_descent/lon': (), 'mozaic_flight_2012030412545335_ascent/air_press': (60,), 'mozaic_flight_2012030412545335_ascent/CO': (60,), 'mozaic_flight_2012030412545335_ascent/O3': (60,), 'mozaic_flight_2012030412545335_ascent/altitude': (60,), 'mozaic_flight_2012030412545335_ascent/UTC_time': (60,), 'mozaic_flight_2012030412545335_ascent/lat': (), 'mozaic_flight_2012030412545335_ascent/lon': (), 'mozaic_flight_2012030419144751_ascent/air_press': (60,), 'mozaic_flight_2012030419144751_ascent/CO': (60,), 'mozaic_flight_2012030419144751_ascent/O3': (60,), 'mozaic_flight_2012030419144751_ascent/altitude': (60,), 'mozaic_flight_2012030419144751_ascent/UTC_time': (60,), 'mozaic_flight_2012030419144751_ascent/lat': (), 'mozaic_flight_2012030419144751_ascent/lon': (), 'mozaic_flight_2012030319051051_descent/air_press': (78,), 'mozaic_flight_2012030319051051_descent/CO': (78,), 'mozaic_flight_2012030319051051_descent/O3': (78,), 'mozaic_flight_2012030319051051_descent/altitude': (78,), 'mozaic_flight_2012030319051051_descent/UTC_time': (78,), 'mozaic_flight_2012030319051051_descent/lat': (), 'mozaic_flight_2012030319051051_descent/lon': (), 'mozaic_flight_2012030421382353_ascent/air_press': (75,), 'mozaic_flight_2012030421382353_ascent/CO': (75,), 'mozaic_flight_2012030421382353_ascent/O3': (75,), 'mozaic_flight_2012030421382353_ascent/altitude': (75,), 'mozaic_flight_2012030421382353_ascent/UTC_time': (75,), 'mozaic_flight_2012030421382353_ascent/lat': (), 'mozaic_flight_2012030421382353_ascent/lon': ()}
var_values = {'mozaic_flight_2012030403540535_descent/air_press': (np.float64(20610.0), np.float64(100513.0), np.float64(52346.4102564), 0), 'mozaic_flight_2012030419144751_ascent/O3': (np.float64(22.0), np.float64(65.0), np.float64(48.7833333333), 0), 'mozaic_flight_2012030412545335_ascent/O3': (np.float64(-99.0), np.float64(-99.0), np.float64(-99.0), 0), 'mozaic_flight_2012030412545335_ascent/air_press': (np.float64(31253.0), np.float64(100609.0), np.float64(60492.45), 0), 'mozaic_flight_2012030403540535_ascent/air_press': (np.float64(22747.0), np.float64(100769.0), np.float64(54022.1756757), 0), 'mozaic_flight_2012030403540535_ascent/CO': (np.float64(-99.0), np.float64(216.0), np.float64(86.7162162162), 0), 'mozaic_flight_2012030319051051_descent/air_press': (np.float64(20564.0), np.float64(100478.0), np.float64(52347.6153846), 0), 'mozaic_flight_2012030321335035_descent/O3': (np.float64(-99.0), np.float64(-99.0), np.float64(-99.0), 0), 'mozaic_flight_2012030421382353_ascent/air_press': (np.float64(22144.0), np.float64(100189.0), np.float64(53585.72), 0), 'mozaic_flight_2012030421382353_ascent/CO': (np.float64(-99.0), np.float64(286.0), np.float64(123.2), 0), 'mozaic_flight_2012030319051051_descent/altitude': (np.float64(70.8), np.float64(11607.6), np.float64(5850.12307692), 0), 'mozaic_flight_2012030319051051_descent/CO': (np.float64(-99.0), np.float64(-99.0), np.float64(-99.0), 0), 'mozaic_flight_2012030421382353_ascent/altitude': (np.float64(95.0), np.float64(11138.2), np.float64(5626.22), 0), 'mozaic_flight_2012030412545335_ascent/altitude': (np.float64(59.8), np.float64(8889.0), np.float64(4499.29166667), 0), 'mozaic_flight_2012030403540535_descent/O3': (np.float64(-99.0), np.float64(-99.0), np.float64(-99.0), 0), 'mozaic_flight_2012030403540535_ascent/O3': (np.float64(-99.0), np.float64(-99.0), np.float64(-99.0), 0), 'mozaic_flight_2012030412545335_ascent/CO': (np.float64(-99.0), np.float64(213.0), np.float64(109.85), 0), 'mozaic_flight_2012030403540535_ascent/altitude': (np.float64(46.4), np.float64(10967.9), np.float64(5549.7027027), 0), 'mozaic_flight_2012030403540535_descent/altitude': (np.float64(67.9), np.float64(11593.5), np.float64(5849.96025641), 0), 'mozaic_flight_2012030403540535_descent/CO': (np.float64(-99.0), np.float64(269.0), np.float64(85.5), 0), 'mozaic_flight_2012030321335035_descent/air_press': (np.float64(21623.0), np.float64(100674.0), np.float64(53160.5921053), 0), 'mozaic_flight_2012030319051051_descent/O3': (np.float64(3.0), np.float64(157.0), np.float64(55.9487179487), 0), 'mozaic_flight_2012030419144751_ascent/altitude': (np.float64(97.4), np.float64(8917.5), np.float64(4498.55166667), 0), 'mozaic_flight_2012030419144751_ascent/air_press': (np.float64(31122.0), np.float64(100160.0), np.float64(60498.45), 0), 'mozaic_flight_2012030419144751_ascent/CO': (np.float64(-99.0), np.float64(-99.0), np.float64(-99.0), 0), 'mozaic_flight_2012030421382353_ascent/O3': (np.float64(21.0), np.float64(219.0), np.float64(52.64), 0), 'mozaic_flight_2012030321335035_descent/CO': (np.float64(-99.0), np.float64(194.0), np.float64(85.7368421053), 0), 'mozaic_flight_2012030321335035_descent/altitude': (np.float64(54.3), np.float64(11289.4), np.float64(5702.44342105), 0)}

def get_coord_dims(var):
    return [dim for dim in var.dimensions if dim in var.file.variables.keys()]

if __name__ == '__main__':
    ut.main()
